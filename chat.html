<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FloraAI - –°–æ–∑–¥–∞–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç —Å –ò–ò</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #da82c1;
            --primary-light: #f7def4;
            --secondary: #d23f5f;
            --accent: #4fd1c7;
            --success: #38b2ac;
            --dark: #2d3748;
            --light: #f7fafc;
            --gray: #718096;
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --progress: 0%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            color: var(--dark);
            background: linear-gradient(135deg, #f9f7ff 0%, #f0edff 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* –®–∞–ø–∫–∞ —á–∞—Ç–∞ */
        .chat-header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            position: relative;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-avatar {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .header-info h1 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .header-info p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –±—É–∫–µ—Ç–∞ */
        .creation-progress {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex-shrink: 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-title {
            font-size: 0.95rem;
            color: var(--dark);
            font-weight: 600;
        }

        .progress-step {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: var(--light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            width: var(--progress);
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π */
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: white;
        }

        .message {
            max-width: 85%;
            padding: 16px 20px;
            border-radius: var(--radius);
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-message {
            align-self: flex-start;
            background: #f8f9ff;
            color: var(--dark);
            border-bottom-left-radius: 5px;
            border: 1px solid var(--border);
        }

        .user-message {
            align-self: flex-end;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .ai-message .message-header {
            color: var(--primary);
        }

        .user-message .message-header {
            color: rgba(255, 255, 255, 0.9);
        }

        /* –ö–Ω–æ–ø–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ */
        .options-container {
            margin-top: 15px;
        }

        .options-title {
            font-size: 0.95rem;
            color: var(--gray);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }

        .option-btn {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 12px 15px;
            font-size: 0.95rem;
            color: var(--dark);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-btn:hover {
            border-color: var(--primary);
            background: rgba(138, 79, 255, 0.05);
        }

        .option-btn.selected {
            border-color: var(--primary);
            background: rgba(138, 79, 255, 0.1);
            color: var(--primary);
            font-weight: 600;
        }

        .option-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--primary);
        }

        .option-btn.selected .option-icon {
            background: var(--primary);
            color: white;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±—É–∫–µ—Ç–∞ */
        .bouquet-result {
            background: linear-gradient(135deg, #fff9f9 0%, #fff0f5 100%);
            border-radius: var(--radius);
            padding: 25px;
            margin-top: 20px;
            border: 2px solid #ffebee;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .result-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--secondary) 0%, #ff8fa3 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .result-title {
            font-size: 1.5rem;
            color: var(--dark);
            font-weight: 700;
        }

        .bouquet-image-container {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .bouquet-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .image-placeholder {
            text-align: center;
            color: var(--gray);
        }

        .image-placeholder i {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .generating-text {
            margin-top: 15px;
            font-size: 1.1rem;
            color: var(--primary);
            font-weight: 600;
        }

        .bouquet-description {
            color: var(--dark);
            line-height: 1.8;
            font-size: 1.05rem;
            margin-bottom: 25px;
            font-style: italic;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border-left: 4px solid var(--accent);
        }

        .bouquet-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .detail-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .detail-card-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .detail-card-value {
            font-size: 1rem;
            color: var(--dark);
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .action-btn {
            flex: 1;
            padding: 16px 20px;
            border-radius: var(--radius);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .order-btn {
            background: linear-gradient(90deg, var(--secondary) 0%, #ff8fa3 100%);
            color: white;
        }

        .order-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 107, 139, 0.3);
        }

        .restart-btn {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .restart-btn:hover {
            background: rgba(138, 79, 255, 0.1);
        }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: white;
            flex-shrink: 0;
            display: none;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 15px 20px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 1rem;
            resize: none;
            max-height: 120px;
            min-height: 60px;
            transition: border-color 0.3s;
            background: var(--light);
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(138, 79, 255, 0.1);
        }

        .send-button {
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(138, 79, 255, 0.3);
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 10px 20px;
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            align-self: flex-start;
            max-width: 100px;
            margin-bottom: 10px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--gray);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* –§—É—Ç–µ—Ä */
        .chat-footer {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid var(--border);
            text-align: center;
            font-size: 0.85rem;
            color: var(--gray);
            flex-shrink: 0;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            body {
                height: 100vh;
            }
            
            .chat-header {
                padding: 15px;
            }
            
            .ai-avatar {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .header-info h1 {
                font-size: 1.1rem;
            }
            
            .message {
                max-width: 90%;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .bouquet-details {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .bouquet-image-container {
                height: 250px;
            }
        }

        @media (max-width: 480px) {
            .chat-messages {
                padding: 15px;
            }
            
            .message {
                max-width: 95%;
                padding: 12px 15px;
            }
            
            .input-wrapper {
                flex-direction: column;
            }
            
            .send-button {
                width: 100%;
                height: 45px;
                border-radius: var(--radius);
                margin-top: 10px;
            }
            
            .bouquet-image-container {
                height: 200px;
            }
        }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ */
        @media (min-width: 500px) {
            body {
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            }
        }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ —á–∞—Ç–∞ -->
    <div class="chat-header">
        <div class="header-left">
            <div class="ai-avatar">
                <i class="fas fa-seedling"></i>
            </div>
            <div class="header-info">
                <h1>FloraAI: –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–ª–æ—Ä–∏—Å—Ç —Å –ò–ò</h1>
                <p>–°–æ–∑–¥–∞–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å</p>
            </div>
        </div>
        <button class="close-btn" id="closeBtn">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è -->
    <div class="creation-progress" id="creationProgress">
        <div class="progress-header">
            <div class="progress-title">–°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –±—É–∫–µ—Ç–∞</div>
            <div class="progress-step" id="progressStep">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 6</div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∞—Ç–∞ -->
    <div class="chat-container">
        <!-- –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div class="chat-messages" id="chatMessages">
            <!-- –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ò–ò -->
            <div class="message ai-message" id="initialMessage">
                <div class="message-header">
                    <i class="fas fa-robot"></i>
                    <span>FloraAI</span>
                </div>
                <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üå∑ –Ø –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–ª–æ—Ä–∏—Å—Ç —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º. –ü–æ–º–æ–≥—É —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Ü–≤–µ—Ç–æ—á–Ω—É—é –∫–æ–º–ø–æ–∑–∏—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∏–¥–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—Å—Ç –≤–∞—à–∏ —á—É–≤—Å—Ç–≤–∞.</p>
                <p>–Ø –∑–∞–¥–∞–º –≤–∞–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è!</p>
            </div>
        </div>

        <!-- –§—É—Ç–µ—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
        <div class="chat-footer">
            <i class="fas fa-lock"></i> –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—É–∫–µ—Ç–∞
        </div>
    </div>

    <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="chat-input-container" id="chatInputContainer">
        <div class="input-wrapper">
            <textarea 
                class="chat-input" 
                id="userInput" 
                placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç –∑–¥–µ—Å—å..." 
                rows="2"></textarea>
            <button class="send-button" id="sendButton">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            currentQuestion: 0,
            answers: {
                forWhom: null,
                age: null,
                colors: null,
                note: null,
                occasion: null,
                chocolate: null
            },
            isGenerating: false
        };

        // –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–ø—Ä–æ—Å–∞
        const questions = [
            {
                id: 'forWhom',
                text: '–î–ª—è –∫–æ–≥–æ –±—É–∫–µ—Ç?',
                options: [
                    { text: '–î–ª—è –∂–µ–Ω—ã/–º—É–∂–∞', icon: 'fas fa-heart', value: '—Å—É–ø—Ä—É–≥(–∞)' },
                    { text: '–î–ª—è –º–∞–º—ã/–ø–∞–ø—ã', icon: 'fas fa-home', value: '—Ä–æ–¥–∏—Ç–µ–ª—å' },
                    { text: '–î–ª—è –¥–µ–≤—É—à–∫–∏/–ø–∞—Ä–Ω—è', icon: 'fas fa-user-friends', value: '–≤–æ–∑–ª—é–±–ª–µ–Ω–Ω—ã–π(–∞—è)' },
                    { text: '–ö–æ–ª–ª–µ–≥–µ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è', icon: 'fas fa-briefcase', value: '–∫–æ–ª–ª–µ–≥–∞' },
                    { text: '–ü–æ–¥—Ä—É–≥–µ/–¥—Ä—É–≥—É', icon: 'fas fa-user', value: '–¥—Ä—É–≥' },
                    { text: '–°–µ–±–µ –≤ –æ—Ñ–∏—Å/–¥–æ–º–æ–π', icon: 'fas fa-building', value: '—Å–µ–±–µ' }
                ]
            },
            {
                id: 'age',
                text: '–ö–∞–∫–æ–π –≤–æ–∑—Ä–∞—Å—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è?',
                options: [
                    { text: '–†–µ–±–µ–Ω–æ–∫ (–¥–æ 12 –ª–µ—Ç)', icon: 'fas fa-child', value: '—Ä–µ–±–µ–Ω–æ–∫' },
                    { text: '–ü–æ–¥—Ä–æ—Å—Ç–æ–∫ (13-19 –ª–µ—Ç)', icon: 'fas fa-user-graduate', value: '–ø–æ–¥—Ä–æ—Å—Ç–æ–∫' },
                    { text: '–ú–æ–ª–æ–¥–æ–π (20-35 –ª–µ—Ç)', icon: 'fas fa-user', value: '–º–æ–ª–æ–¥–æ–π' },
                    { text: '–í–∑—Ä–æ—Å–ª—ã–π (36-55 –ª–µ—Ç)', icon: 'fas fa-user-tie', value: '–≤–∑—Ä–æ—Å–ª—ã–π' },
                    { text: '–ü–æ–∂–∏–ª–∞—è –∂–µ–Ω—â–∏–Ω–∞/–º—É–∂—á–∏–Ω–∞', icon: 'fas fa-user-friends', value: '–ø–æ–∂–∏–ª–æ–π' },
                    { text: '–ù–µ –≤–∞–∂–Ω–æ', icon: 'fas fa-times', value: '–Ω–µ –≤–∞–∂–Ω–æ' }
                ]
            },
            {
                id: 'colors',
                text: '–ö–∞–∫–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã?',
                options: [
                    { text: '–ù–µ–∂–Ω—ã–µ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ', icon: 'fas fa-pastafarianism', value: '–ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ', color: '#ffd6e7' },
                    { text: '–Ø—Ä–∫–∏–µ –∏ —Å–æ—á–Ω—ã–µ', icon: 'fas fa-fire', value: '—è—Ä–∫–∏–µ', color: '#ff6b6b' },
                    { text: '–ë–µ–ª–æ-–∑–µ–ª–µ–Ω—ã–µ', icon: 'fas fa-leaf', value: '–±–µ–ª–æ-–∑–µ–ª–µ–Ω—ã–µ', color: '#51cf66' },
                    { text: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∫—Ä–∞—Å–Ω—ã–µ', icon: 'fas fa-heart', value: '–∫—Ä–∞—Å–Ω—ã–µ', color: '#ff6b6b' },
                    { text: '–†–æ–∑–æ–≤—ã–µ —Ç–æ–Ω–∞', icon: 'fas fa-heart', value: '—Ä–æ–∑–æ–≤—ã–µ', color: '#ff8787' },
                    { text: '–°–∏–Ω–∏–µ/—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ', icon: 'fas fa-moon', value: '—Å–∏–Ω–∏–µ', color: '#748ffc' }
                ]
            },
            {
                id: 'note',
                text: '–ù—É–∂–Ω–∞ –ª–∏ –∑–∞–ø–∏—Å–∫–∞ –∫ –±—É–∫–µ—Ç—É?',
                options: [
                    { text: '–î–∞, —Å —Ç–µ–∫—Å—Ç–æ–º "–° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è!"', icon: 'fas fa-birthday-cake', value: '—Å –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è' },
                    { text: '–î–∞, —Å —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º', icon: 'fas fa-heart', value: '—Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è' },
                    { text: '–î–∞, —Å–æ —Å–≤–æ–∏–º —Ç–µ–∫—Å—Ç–æ–º', icon: 'fas fa-pen', value: '—Å–≤–æ—è' },
                    { text: '–î–∞, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞', icon: 'fas fa-envelope', value: '—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è' },
                    { text: '–ù–µ—Ç, –∑–∞–ø–∏—Å–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞', icon: 'fas fa-times', value: '–Ω–µ—Ç' },
                    { text: '–ü–æ–∫–∞ –Ω–µ –∑–Ω–∞—é', icon: 'fas fa-question', value: '–Ω–µ –∑–Ω–∞—é' }
                ]
            },
            {
                id: 'occasion',
                text: '–ü–æ–≤–æ–¥ –¥–ª—è –±—É–∫–µ—Ç–∞?',
                options: [
                    { text: '8 –º–∞—Ä—Ç–∞', icon: 'fas fa-female', value: '8 –º–∞—Ä—Ç–∞' },
                    { text: '–°–≤–∞–¥—å–±–∞', icon: 'fas fa-ring', value: '—Å–≤–∞–¥—å–±–∞' },
                    { text: '–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è', icon: 'fas fa-birthday-cake', value: '–¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è' },
                    { text: '–ì–æ–¥–æ–≤—â–∏–Ω–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–π', icon: 'fas fa-heart', value: '–≥–æ–¥–æ–≤—â–∏–Ω–∞' },
                    { text: '–ü—Ä–æ—Å—Ç–æ —Ç–∞–∫/–±–µ–∑ –ø–æ–≤–æ–¥–∞', icon: 'fas fa-surprise', value: '–±–µ–∑ –ø–æ–≤–æ–¥–∞' },
                    { text: '–ò–∑–≤–∏–Ω–µ–Ω–∏–µ', icon: 'fas fa-dove', value: '–∏–∑–≤–∏–Ω–µ–Ω–∏–µ' }
                ]
            },
            {
                id: 'chocolate',
                text: '–î–æ–ø–æ–ª–Ω–∏—Ç—å —Å–ª–∞–¥–∫–∏–º –ø–æ–¥–∞—Ä–∫–æ–º?',
                options: [
                    { text: '–î–∞, –∫–æ—Ä–æ–±–∫–∞ —à–æ–∫–æ–ª–∞–¥–æ–≤', icon: 'fas fa-candy-cane', value: '—à–æ–∫–æ–ª–∞–¥' },
                    { text: '–î–∞, –ø–µ—á–µ–Ω—å–µ/–º–∞–∫–∞—Ä—É–Ω—ã', icon: 'fas fa-cookie', value: '–ø–µ—á–µ–Ω—å–µ' },
                    { text: '–î–∞, –º–µ–¥/–≤–∞—Ä–µ–Ω—å–µ', icon: 'fas fa-jar', value: '–º–µ–¥' },
                    { text: '–î–∞, —Å—é—Ä–ø—Ä–∏–∑ –Ω–∞ –≤—ã–±–æ—Ä', icon: 'fas fa-gift', value: '—Å—é—Ä–ø—Ä–∏–∑' },
                    { text: '–ù–µ—Ç, —Ç–æ–ª—å–∫–æ –±—É–∫–µ—Ç', icon: 'fas fa-times', value: '–Ω–µ—Ç' },
                    { text: '–ü–æ–∫–∞ –Ω–µ –∑–Ω–∞—é', icon: 'fas fa-question', value: '–Ω–µ –∑–Ω–∞—é' }
                ]
            }
        ];

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const sendButton = document.getElementById('sendButton');
        const closeBtn = document.getElementById('closeBtn');
        const chatInputContainer = document.getElementById('chatInputContainer');
        const creationProgress = document.getElementById('creationProgress');
        const progressFill = document.getElementById('progressFill');
        const progressStep = document.getElementById('progressStep');
        const root = document.documentElement;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        function updateProgressBar() {
            const progress = ((state.currentQuestion) / 6) * 100;
            root.style.setProperty('--progress', `${progress}%`);
            progressFill.style.width = `${progress}%`;
            progressStep.textContent = state.currentQuestion === 6 ? '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±—É–∫–µ—Ç–∞...' : `–í–æ–ø—Ä–æ—Å ${state.currentQuestion + 1} –∏–∑ 6`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return typingDiv;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞
        function removeTypingIndicator(typingElement) {
            if (typingElement && typingElement.parentNode) {
                typingElement.remove();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function addMessage(text, isUser = false, options = null) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
            
            let messageHTML = `
                <div class="message-header">
                    <i class="fas ${isUser ? 'fa-user' : 'fa-robot'}"></i>
                    <span>${isUser ? '–í—ã' : 'FloraAI'}</span>
                </div>
                <p>${text}</p>
            `;
            
            // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –æ–ø—Ü–∏–∏, –¥–æ–±–∞–≤–ª—è–µ–º –∏—Ö
            if (options && !isUser) {
                messageHTML += `
                    <div class="options-container">
                        <div class="options-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:</div>
                        <div class="options-grid" id="optionsGrid">
                `;
                
                options.forEach((option, index) => {
                    messageHTML += `
                        <button class="option-btn" data-index="${index}" data-value="${option.value}">
                            <div class="option-icon">
                                <i class="${option.icon}"></i>
                            </div>
                            ${option.text}
                        </button>
                    `;
                });
                
                messageHTML += `
                        </div>
                    </div>
                `;
            }
            
            messageDiv.innerHTML = messageHTML;
            chatMessages.appendChild(messageDiv);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ–ø—Ü–∏–π
            if (options && !isUser) {
                setTimeout(() => {
                    const optionButtons = messageDiv.querySelectorAll('.option-btn');
                    optionButtons.forEach(button => {
                        button.addEventListener('click', function() {
                            const index = parseInt(this.getAttribute('data-index'));
                            const value = this.getAttribute('data-value');
                            
                            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                            optionButtons.forEach(btn => btn.classList.remove('selected'));
                            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É
                            this.classList.add('selected');
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç
                            handleOptionSelect(value);
                        });
                    });
                }, 100);
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            return messageDiv;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞ –æ–ø—Ü–∏–∏
        function handleOptionSelect(value) {
            const currentQuestion = questions[state.currentQuestion];
            state.answers[currentQuestion.id] = value;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const selectedOption = currentQuestion.options.find(opt => opt.value === value);
            addMessage(selectedOption.text, true);
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
            setTimeout(() => {
                state.currentQuestion++;
                
                if (state.currentQuestion < questions.length) {
                    // –ó–∞–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
                    askNextQuestion();
                } else {
                    // –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–¥–∞–Ω—ã, –Ω–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –±—É–∫–µ—Ç–∞
                    startBouquetGeneration();
                }
                
                updateProgressBar();
            }, 800);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
        function askNextQuestion() {
            const typingIndicator = showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator(typingIndicator);
                
                const question = questions[state.currentQuestion];
                addMessage(question.text, false, question.options);
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±—É–∫–µ—Ç–∞
        function startBouquetGeneration() {
            state.isGenerating = true;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –≤–æ–ø—Ä–æ—Å–æ–≤
            creationProgress.style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            const typingIndicator = showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator(typingIndicator);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                addMessage("–û—Ç–ª–∏—á–Ω–æ! –Ø –ø–æ–ª—É—á–∏–ª–∞ –≤—Å–µ –≤–∞—à–∏ –æ—Ç–≤–µ—Ç—ã. üå∏ –°–µ–π—á–∞—Å —Å–æ–∑–¥–∞—é —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å...", false);
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                setTimeout(() => {
                    showGeneratedBouquet();
                }, 2500);
            }, 1500);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –±—É–∫–µ—Ç–∞
        function showGeneratedBouquet() {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤
            const bouquetDescription = generateBouquetDescription();
            
            const resultHTML = `
                <div class="bouquet-result">
                    <div class="result-header">
                        <div class="result-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <div class="result-title">–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç –≥–æ—Ç–æ–≤!</div>
                    </div>
                    
                    <div class="bouquet-image-container">
                        <div class="image-placeholder" id="imagePlaceholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <div class="generating-text">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...</div>
                        </div>
                        <img class="bouquet-image" id="bouquetImage" src="" alt="–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç">
                    </div>
                    
                    <div class="bouquet-description" id="bouquetDescription">
                        ${bouquetDescription}
                    </div>
                    
                    <div class="bouquet-details">
                        <div class="detail-card">
                            <div class="detail-card-title">–î–ª—è –∫–æ–≥–æ</div>
                            <div class="detail-card-value">${getOptionText('forWhom')}</div>
                        </div>
                        <div class="detail-card">
                            <div class="detail-card-title">–í–æ–∑—Ä–∞—Å—Ç</div>
                            <div class="detail-card-value">${getOptionText('age')}</div>
                        </div>
                        <div class="detail-card">
                            <div class="detail-card-title">–¶–≤–µ—Ç–∞</div>
                            <div class="detail-card-value">${getOptionText('colors')}</div>
                        </div>
                        <div class="detail-card">
                            <div class="detail-card-title">–ü–æ–≤–æ–¥</div>
                            <div class="detail-card-value">${getOptionText('occasion')}</div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn order-btn" id="orderBtn">
                            <i class="fab fa-telegram"></i> –°–≤—è–∑–∞—Ç—å—Å—è —Å —Ñ–ª–æ—Ä–∏—Å—Ç–æ–º üå∏
                        </button>
                        <button class="action-btn restart-btn" id="restartBtn">
                            <i class="fas fa-redo"></i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –±—É–∫–µ—Ç
                        </button>
                    </div>
                </div>
            `;
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            const resultDiv = document.createElement('div');
            resultDiv.innerHTML = resultHTML;
            chatMessages.appendChild(resultDiv);
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            simulateImageGeneration();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
            document.getElementById('orderBtn').addEventListener('click', connectToFlorist);
            document.getElementById('restartBtn').addEventListener('click', restartQuestionnaire);
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –æ–ø—Ü–∏–∏ –ø–æ ID –≤–æ–ø—Ä–æ—Å–∞
        function getOptionText(questionId) {
            const question = questions.find(q => q.id === questionId);
            const option = question.options.find(opt => opt.value === state.answers[questionId]);
            return option ? option.text : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏—è –±—É–∫–µ—Ç–∞
        function generateBouquetDescription() {
            const descriptions = {
                '—Å—É–ø—Ä—É–≥(–∞)': '–≠—Ç–æ—Ç –±—É–∫–µ—Ç —Å–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–π –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–∫–∏. –ö–∞–∂–¥—ã–π —Ü–≤–µ—Ç–æ–∫ –≤ –Ω—ë–º —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –≥—Ä–∞–Ω–∏ –≤–∞—à–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π: —Å—Ç—Ä–∞—Å—Ç—å, –Ω–µ–∂–Ω–æ—Å—Ç—å, –≤–µ—Ä–Ω–æ—Å—Ç—å –∏ –≤–µ—á–Ω—É—é –ª—é–±–æ–≤—å.',
                '—Ä–æ–¥–∏—Ç–µ–ª—å': '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ç–µ–ø–ª–æ—Ç–æ–π –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é. –¶–≤–µ—Ç—ã –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –≤—ã—Ä–∞–∑–∏—Ç—å –≤—Å—é –≥–ª—É–±–∏–Ω—É –≤–∞—à–∏—Ö —á—É–≤—Å—Ç–≤ –∫ —Å–∞–º–æ–º—É –±–ª–∏–∑–∫–æ–º—É —á–µ–ª–æ–≤–µ–∫—É.',
                '–≤–æ–∑–ª—é–±–ª–µ–Ω–Ω—ã–π(–∞—è)': '–†–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π –±—É–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç –±–µ–∑ —Å–ª–æ–≤. –ù–µ–∂–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏ –∏ –∏–∑—è—â–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞—é—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∑–∞—Ä–æ–∂–¥–∞—é—â–∏—Ö—Å—è —á—É–≤—Å—Ç–≤ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ–π —Å–≤—è–∑–∏.',
                '–∫–æ–ª–ª–µ–≥–∞': '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –∏ —Å–¥–µ—Ä–∂–∞–Ω–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–ª—è –¥–µ–ª–æ–≤–æ–π —Å—Ä–µ–¥—ã. –í—ã—Ä–∞–∂–∞–µ—Ç —É–≤–∞–∂–µ–Ω–∏–µ –∏ –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω.',
                '–¥—Ä—É–≥': '–ñ–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω—ã–π –∏ –Ω–µ–ø—Ä–∏–Ω—É–∂–¥—ë–Ω–Ω—ã–π –±—É–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–µ—Ç –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º —Å–∫–∞–∑–∞—Ç—å "—è —Ü–µ–Ω—é –Ω–∞—à—É –¥—Ä—É–∂–±—É".',
                '—Å–µ–±–µ': '–ë—É–∫–µ—Ç –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ü–µ–Ω–∏—Ç –∫—Ä–∞—Å–æ—Ç—É –≤–æ–∫—Ä—É–≥ —Å–µ–±—è. –ö–æ–º–ø–æ–∑–∏—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–¥–æ–≤–∞—Ç—å –≤–∞—Å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Å–æ–±–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.'
            };
            
            const baseDescription = descriptions[state.answers.forWhom] || '–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è.';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏ –ø–æ —Ü–≤–µ—Ç–∞–º
            let colorDescription = '';
            if (state.answers.colors === '–ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ') {
                colorDescription = '–ù–µ–∂–Ω—ã–µ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–æ–∑–¥–∞—é—Ç –æ—â—É—â–µ–Ω–∏–µ –ª—ë–≥–∫–æ—Å—Ç–∏ –∏ —á–∏—Å—Ç–æ—Ç—ã, –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω–∏–π —Ç—É–º–∞–Ω –Ω–∞–¥ —Ü–≤–µ—Ç—É—â–∏–º –ª—É–≥–æ–º.';
            } else if (state.answers.colors === '—è—Ä–∫–∏–µ') {
                colorDescription = '–Ø—Ä–∫–∏–µ, —Å–æ—á–Ω—ã–µ —Ü–≤–µ—Ç–∞ –Ω–∞–ø–æ–ª–Ω—è—é—Ç –∫–æ–º–ø–æ–∑–∏—Ü–∏—é —ç–Ω–µ—Ä–≥–∏–µ–π –∏ –∂–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω–æ—Å—Ç—å—é, –ø—Ä–∏—Ç—è–≥–∏–≤–∞—è –≤–∑–≥–ª—è–¥—ã –∏ –ø–æ–¥–Ω–∏–º–∞—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.';
            } else if (state.answers.colors === '–±–µ–ª–æ-–∑–µ–ª–µ–Ω—ã–µ') {
                colorDescription = '–ì–∞—Ä–º–æ–Ω–∏—è –±–µ–ª–æ–≥–æ –∏ –∑–µ–ª—ë–Ω–æ–≥–æ —Å–æ–∑–¥–∞—ë—Ç –æ—â—É—â–µ–Ω–∏–µ —Å–≤–µ–∂–µ—Å—Ç–∏ –∏ —á–∏—Å—Ç–æ—Ç—ã, –Ω–∞–ø–æ–º–∏–Ω–∞—è –æ –≤–µ—Å–µ–Ω–Ω–µ–º –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–∏ –ø—Ä–∏—Ä–æ–¥—ã.';
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏ –ø–æ –ø–æ–≤–æ–¥—É
            let occasionDescription = '';
            if (state.answers.occasion === '–¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è') {
                occasionDescription = '–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω –¥–ª—è –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî –∫–∞–∂–¥—ã–π —Ü–≤–µ—Ç–æ–∫ –Ω–µ—Å—ë—Ç –ø–æ–∂–µ–ª–∞–Ω–∏–µ —Å—á–∞—Å—Ç—å—è, –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ä–∞–¥–æ—Å—Ç–∏ –Ω–∞ –≤–µ—Å—å —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥.';
            } else if (state.answers.occasion === '8 –º–∞—Ä—Ç–∞') {
                occasionDescription = '–í–µ—Å–µ–Ω–Ω—è—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –∂–µ–Ω—Å–∫–æ–≥–æ –¥–Ω—è, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ, –∫—Ä–∞—Å–æ—Ç—É –∏ –Ω–µ–∂–Ω–æ—Å—Ç—å.';
            } else if (state.answers.occasion === '–≥–æ–¥–æ–≤—â–∏–Ω–∞') {
                occasionDescription = '–≠—Ç–æ—Ç –±—É–∫–µ—Ç —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤–∞—à–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π ‚Äî –æ—Ç –ø–µ—Ä–≤—ã—Ö –Ω–µ–∂–Ω—ã—Ö —á—É–≤—Å—Ç–≤ –¥–æ –≥–ª—É–±–æ–∫–æ–π –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Å –≥–æ–¥–∞–º–∏ —Ç–æ–ª—å–∫–æ –∫—Ä–µ–ø–Ω–µ—Ç.';
            }
            
            return `${baseDescription} ${colorDescription} ${occasionDescription} –Ø —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–ª–∞ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –≥–∞—Ä–º–æ–Ω–∏—á–Ω—É—é –∫–æ–º–ø–æ–∑–∏—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–¥–æ–≤–∞—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª—è –∏ —Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Å—Ç –≤–∞—à–∏ —á—É–≤—Å—Ç–≤–∞.`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function simulateImageGeneration() {
            setTimeout(() => {
                const imagePlaceholder = document.getElementById('imagePlaceholder');
                const bouquetImage = document.getElementById('bouquetImage');
                
                // –°–æ–∑–¥–∞–µ–º "—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ" –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –ò–ò –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                let colorTheme = 'pastel';
                if (state.answers.colors === '—è—Ä–∫–∏–µ') colorTheme = 'bright';
                if (state.answers.colors === '–∫—Ä–∞—Å–Ω—ã–µ') colorTheme = 'red';
                if (state.answers.colors === '—Å–∏–Ω–∏–µ') colorTheme = 'blue';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –±—É–∫–µ—Ç–∞
                let bouquetType = 'romantic';
                if (state.answers.forWhom === '–∫–æ–ª–ª–µ–≥–∞') bouquetType = 'elegant';
                if (state.answers.forWhom === '—Å–µ–±–µ') bouquetType = 'minimalist';
                if (state.answers.occasion === '—Å–≤–∞–¥—å–±–∞') bouquetType = 'wedding';
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–∞
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ DALL-E, Stable Diffusion –∏–ª–∏ –¥—Ä—É–≥–æ–º—É –ò–ò
                
                // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
                const gradients = {
                    '–ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ': 'linear-gradient(135deg, #ffd6e7 0%, #c8f7c5 50%, #a6dcef 100%)',
                    '—è—Ä–∫–∏–µ': 'linear-gradient(135deg, #ff6b6b 0%, #ffd93d 50%, #6bcf7f 100%)',
                    '–±–µ–ª–æ-–∑–µ–ª–µ–Ω—ã–µ': 'linear-gradient(135deg, #ffffff 0%, #c8f7c5 50%, #51cf66 100%)',
                    '–∫—Ä–∞—Å–Ω—ã–µ': 'linear-gradient(135deg, #ff6b6b 0%, #ff8787 50%, #ffa8a8 100%)',
                    '—Ä–æ–∑–æ–≤—ã–µ': 'linear-gradient(135deg, #ff8787 0%, #fcc2d7 50%, #e599f7 100%)',
                    '—Å–∏–Ω–∏–µ': 'linear-gradient(135deg, #748ffc 0%, #3bc9db 50%, #38d9a9 100%)'
                };
                
                const gradient = gradients[state.answers.colors] || gradients['–ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ'];
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ" –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                imagePlaceholder.style.display = 'none';
                bouquetImage.style.display = 'block';
                
                // –°–æ–∑–¥–∞–µ–º canvas –¥–ª—è "–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏" –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                const canvas = document.createElement('canvas');
                canvas.width = 600;
                canvas.height = 400;
                const ctx = canvas.getContext('2d');
                
                // –†–∏—Å—É–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
                const bgGradient = ctx.createLinearGradient(0, 0, 600, 400);
                bgGradient.addColorStop(0, gradient.split(' ')[2]);
                bgGradient.addColorStop(0.5, gradient.split(' ')[4]);
                bgGradient.addColorStop(1, gradient.split(' ')[6]);
                
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, 600, 400);
                
                // –†–∏—Å—É–µ–º –ø—Ä–æ—Å—Ç—ã–µ —Ñ–∏–≥—É—Ä—ã –≤ –≤–∏–¥–µ —Ü–≤–µ—Ç–æ–≤
                drawFlowers(ctx, colorTheme, bouquetType);
                
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º canvas –≤ data URL
                bouquetImage.src = canvas.toDataURL('image/png');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Ç–µ–∫—Å—Ç –æ–± "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–µ"
                addMessage("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–∫–µ—Ç–∞ –±—ã–ª–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π. –í —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –Ω–∞—à —Ñ–ª–æ—Ä–∏—Å—Ç –≤–æ—Å—Å–æ–∑–¥–∞—Å—Ç —ç—Ç—É –∫–æ–º–ø–æ–∑–∏—Ü–∏—é —Å –∂–∏–≤—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏!", false);
                
            }, 2000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö —Ü–≤–µ—Ç–æ–≤ –Ω–∞ canvas
        function drawFlowers(ctx, colorTheme, bouquetType) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
            let flowerColors, stemColor;
            
            switch(colorTheme) {
                case 'bright':
                    flowerColors = ['#ff6b6b', '#ffd93d', '#51cf66', '#339af0'];
                    stemColor = '#2b8a3e';
                    break;
                case 'red':
                    flowerColors = ['#ff6b6b', '#ff8787', '#ffa8a8'];
                    stemColor = '#2b8a3e';
                    break;
                case 'blue':
                    flowerColors = ['#339af0', '#748ffc', '#5c7cfa'];
                    stemColor = '#2b8a3e';
                    break;
                default: // pastel
                    flowerColors = ['#ffd6e7', '#c8f7c5', '#a6dcef', '#e599f7'];
                    stemColor = '#51cf66';
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –±—É–∫–µ—Ç–∞
            let flowerCount, positions;
            
            switch(bouquetType) {
                case 'elegant':
                    flowerCount = 7;
                    positions = [
                        {x: 300, y: 200, size: 40},
                        {x: 250, y: 180, size: 30},
                        {x: 350, y: 180, size: 30},
                        {x: 220, y: 220, size: 25},
                        {x: 380, y: 220, size: 25},
                        {x: 280, y: 250, size: 20},
                        {x: 320, y: 250, size: 20}
                    ];
                    break;
                case 'minimalist':
                    flowerCount = 5;
                    positions = [
                        {x: 300, y: 200, size: 35},
                        {x: 270, y: 180, size: 25},
                        {x: 330, y: 180, size: 25},
                        {x: 250, y: 220, size: 20},
                        {x: 350, y: 220, size: 20}
                    ];
                    break;
                case 'wedding':
                    flowerCount = 9;
                    positions = [
                        {x: 300, y: 200, size: 45},
                        {x: 250, y: 170, size: 35},
                        {x: 350, y: 170, size: 35},
                        {x: 220, y: 210, size: 30},
                        {x: 380, y: 210, size: 30},
                        {x: 270, y: 230, size: 25},
                        {x: 330, y: 230, size: 25},
                        {x: 240, y: 250, size: 20},
                        {x: 360, y: 250, size: 20}
                    ];
                    break;
                default: // romantic
                    flowerCount = 8;
                    positions = [
                        {x: 300, y: 200, size: 40},
                        {x: 260, y: 180, size: 35},
                        {x: 340, y: 180, size: 35},
                        {x: 230, y: 210, size: 30},
                        {x: 370, y: 210, size: 30},
                        {x: 280, y: 230, size: 25},
                        {x: 320, y: 230, size: 25},
                        {x: 300, y: 260, size: 20}
                    ];
            }
            
            // –†–∏—Å—É–µ–º —Å—Ç–µ–±–ª–∏
            positions.forEach(pos => {
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y + pos.size/2);
                ctx.lineTo(pos.x, 380);
                ctx.lineWidth = 3;
                ctx.strokeStyle = stemColor;
                ctx.stroke();
            });
            
            // –†–∏—Å—É–µ–º —Ü–≤–µ—Ç—ã
            positions.forEach((pos, index) => {
                const color = flowerColors[index % flowerColors.length];
                
                // –†–∏—Å—É–µ–º –ª–µ–ø–µ—Å—Ç–∫–∏
                for (let i = 0; i < 6; i++) {
                    const angle = (i * Math.PI * 2) / 6;
                    const petalX = pos.x + Math.cos(angle) * pos.size * 0.8;
                    const petalY = pos.y + Math.sin(angle) * pos.size * 0.8;
                    
                    ctx.beginPath();
                    ctx.ellipse(petalX, petalY, pos.size * 0.4, pos.size * 0.6, angle, 0, Math.PI * 2);
                    ctx.fillStyle = color;
                    ctx.fill();
                }
                
                // –†–∏—Å—É–µ–º —Ü–µ–Ω—Ç—Ä —Ü–≤–µ—Ç–∫–∞
                ctx.beginPath();
                ctx.arc(pos.x, pos.y, pos.size * 0.3, 0, Math.PI * 2);
                ctx.fillStyle = colorTheme === 'bright' ? '#ffd93d' : '#ffffff';
                ctx.fill();
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–≤—è–∑–∏ —Å —Ñ–ª–æ—Ä–∏—Å—Ç–æ–º
        function connectToFlorist() {
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Ñ–ª–æ—Ä–∏—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤
            const orderDetails = 
`–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –æ—Ç FloraAI:

üìã –î–µ—Ç–∞–ª–∏ –±—É–∫–µ—Ç–∞:
‚Ä¢ –î–ª—è –∫–æ–≥–æ: ${getOptionText('forWhom')}
‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç: ${getOptionText('age')}
‚Ä¢ –¶–≤–µ—Ç–∞: ${getOptionText('colors')}
‚Ä¢ –ó–∞–ø–∏—Å–∫–∞: ${getOptionText('note')}
‚Ä¢ –ü–æ–≤–æ–¥: ${getOptionText('occasion')}
‚Ä¢ –°–ª–∞–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫: ${getOptionText('chocolate')}

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–∫–µ—Ç–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ò–ò.`;

            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º
            // –ù–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Telegram Bot API
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ Telegram
            addMessage("–û—Ç–ª–∏—á–Ω–æ! –°–µ–π—á–∞—Å —è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—é –≤–∞—Å –≤ –Ω–∞—à Telegram-—á–∞—Ç —Å —Ñ–ª–æ—Ä–∏—Å—Ç–æ–º, –≥–¥–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ –∏ —É–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏. üå∏", false);
            
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ Telegram –±–æ—Ç–∞
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞
            const telegramBotUrl = "https://t.me/FloraAI_Florist_Bot";
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
            setTimeout(() => {
                window.open(telegramBotUrl, '_blank');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                addMessage(`–ï—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: <a href="${telegramBotUrl}" target="_blank">${telegramBotUrl}</a><br><br>–í —á–∞—Ç–µ —Å —Ñ–ª–æ—Ä–∏—Å—Ç–æ–º –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å –±—É–∫–µ—Ç, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π FloraAI"`, false);
            }, 1500);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –æ–ø—Ä–æ—Å–∞
        function restartQuestionnaire() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            state.currentQuestion = 0;
            state.answers = {
                forWhom: null,
                age: null,
                colors: null,
                note: null,
                occasion: null,
                chocolate: null
            };
            state.isGenerating = false;
            
            // –û—á–∏—â–∞–µ–º —á–∞—Ç
            chatMessages.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
            creationProgress.style.display = 'flex';
            
            // –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ
            addMessage("–û—Ç–ª–∏—á–Ω–æ! –î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –±—É–∫–µ—Ç. üå∏", false);
            updateProgressBar();
            
            setTimeout(() => {
                askNextQuestion();
            }, 1500);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞
        function initChat() {
            updateProgressBar();
            
            // –ù–∞—á–∏–Ω–∞–µ–º –æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                askNextQuestion();
            }, 2000);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        sendButton.addEventListener('click', () => {
            const message = userInput.value.trim();
            if (message) {
                addMessage(message, true);
                userInput.value = '';
                userInput.style.height = 'auto';
            }
        });

        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendButton.click();
            }
        });

        userInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        closeBtn.addEventListener('click', () => {
            if (window.opener) {
                window.close();
            } else {
                addMessage("–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FloraAI! –ï—Å–ª–∏ —Ä–µ—à–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –±—É–∫–µ—Ç –ø–æ–∑–∂–µ, –º—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å. üå∏", false);
            }
        });

        // –ó–∞–ø—É—Å–∫ —á–∞—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', initChat);
    </script>
</body>
</html>